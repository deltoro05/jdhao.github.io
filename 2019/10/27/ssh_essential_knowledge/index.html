<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Essential Knowledge about SSH - jdhao's digital space</title>
<meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="jdhao"><meta name=description content="Although I use SSH (secure shell) every day, I seem to know little about it except the fact that I can use ssh command to log into my remote servers. Recently, I found myself some time to learn how does it work.
"><meta name=keywords content="Hugo,theme,even"><meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw"><meta name=generator content="Hugo 0.123.8 with theme even"><link rel=canonical href=https://jdhao.github.io/2019/10/27/ssh_essential_knowledge/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:!0})</script><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Essential Knowledge about SSH"><meta property="og:description" content="Although I use SSH (secure shell) every day, I seem to know little about it
except the fact that I can use ssh command to log into my remote servers.
Recently, I found myself some time to learn how does it work."><meta property="og:type" content="article"><meta property="og:url" content="https://jdhao.github.io/2019/10/27/ssh_essential_knowledge/"><meta property="article:section" content="post"><meta property="article:published_time" content="2019-10-27T22:43:12+08:00"><meta property="article:modified_time" content="2019-10-27T18:41:54+01:00"><meta itemprop=name content="Essential Knowledge about SSH"><meta itemprop=description content="Although I use SSH (secure shell) every day, I seem to know little about it
except the fact that I can use ssh command to log into my remote servers.
Recently, I found myself some time to learn how does it work."><meta itemprop=datePublished content="2019-10-27T22:43:12+08:00"><meta itemprop=dateModified content="2019-10-27T18:41:54+01:00"><meta itemprop=wordCount content="955"><meta itemprop=keywords content="ssh,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Essential Knowledge about SSH"><meta name=twitter:description content="Although I use SSH (secure shell) every day, I seem to know little about it
except the fact that I can use ssh command to log into my remote servers.
Recently, I found myself some time to learn how does it work."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>jdhao's digital space</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>jdhao's digital space</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Essential Knowledge about SSH</h1><div class=post-meta><span class=post-time>2019-10-27</span><div class=post-category><a href=/categories/technique/>technique</a></div><span class=more-meta>955 words </span><span class=more-meta>5 mins read </span><span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#preliminary-knowledge>Preliminary knowledge</a><ul><li><a href=#fingerprint>Fingerprint</a></li><li><a href=#cryptographic-hash-function>Cryptographic hash function</a></li></ul></li><li><a href=#ssh-to-a-server>SSH to a server</a><ul><li><a href=#server-public-key-verification>Server public key verification</a></li><li><a href=#set-up-public-key-login>Set up public key login</a><ul><li><a href=#transfer-your-public-key-to-server>Transfer your public key to server</a></li><li><a href=#login-to-the-server>login to the server</a></li></ul></li></ul></li><li><a href=#references>References</a></li></ul></nav></div></div><div class=post-content><p>Although I use SSH (secure shell) every day, I seem to know little about it
except the fact that I can use <code>ssh</code> command to log into my remote servers.
Recently, I found myself some time to learn how does it work.</p><h1 id=preliminary-knowledge>Preliminary knowledge</h1><h2 id=fingerprint>Fingerprint</h2><p>In computing, a
<a href=https://en.wikipedia.org/wiki/Public_key_fingerprint>fingerprint</a> is a
shorter sequence representation of a longer message which can be used to
identified the original message. For example, in SSH, when you connect to the
server, you will get the server public key fingerprint. Then you can compare
the fingerprint you have received with the real server fingerprint (e.g., you
may have obtained the server public key fingerprint by contacting the
administrator) to make sure that you are not being attacked by hackers and
connecting the wrong server.</p><h2 id=cryptographic-hash-function>Cryptographic hash function</h2><p>To produce such a fingerprint and ensure security, we need to use
<a href=https://en.wikipedia.org/wiki/Cryptographic_hash_function>cryptographic hash
functions</a>. A
cryptographic hash functions has good properties. It makes sure that same
message always produce the same output and different messages produce different
output. It also makes sure that you can not deduce the original message from
the output. These good properties make it suitable for authentification
purposes. You may have probably used it before when you check the integrity of
files using <a href=https://en.wikipedia.org/wiki/Md5sum><code>md5sum</code></a> or similar tools.</p><p><code>MD5</code> and <code>SHA</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> are different hash function algorithms to generate a
fingerprint. The complete list of hash functions can be found
<a href=https://en.wikipedia.org/wiki/Cryptographic_hash_function#Cryptographic_hash_algorithms>here</a>.</p><h1 id=ssh-to-a-server>SSH to a server</h1><p>Two ways to log in a server when using SSH:</p><ul><li>use your user name and password</li><li>use ssh public key authentification</li></ul><h2 id=server-public-key-verification>Server public key verification</h2><p>When we first log in a server, we will be prompted that the authenticity of the
server can not established, and we are shown the fingerprint of the server&rsquo;s
public key. The typical message is like the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>The authenticity of host &#39;xxx.xx.xx.xx (xx.xx.xx.xx)&#39; can&#39;t be established.
</span></span><span class=line><span class=cl>ECDSA key fingerprint is SHA256:zJsEufeAsutfxsZH990Sq7asIBnJvz6B9N63g0/Rx5w.
</span></span><span class=line><span class=cl>Are you sure you want to continue connecting (yes/no/[fingerprint])?
</span></span></code></pre></div><p>In the above message, <code>ECDSA</code> is a type of signature algorithm used to verify
the identity of the two sides of a communication. Other signature algorithms
include <code>DSA</code>, <code>RSA</code> and <code>ED25519</code>.</p><p>To make sure that the public key of the server is true, you have to check via
other methods. For example, if you have access to the server in other more
secure ways, you can check the fingerprint of the server&rsquo;s ECDSA public key<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
with SHA hash function using the following command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssh-keygen -lf -E sha256 /etc/ssh/ssh_host_ecdsa_key.pub
</span></span></code></pre></div><p>If you want to check the fingerprint of the server in MD5 format, use the
following command instead:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># MD5
</span></span><span class=line><span class=cl>ssh-keygen -E md5 -lf &lt;fileName&gt;
</span></span></code></pre></div><p>Then you can compare the fingerprint of the server public key against the
fingerprint you have received. If the two fingerprints match, you are actually
logging to the right server. Otherwise, you may be under attack by hacker (see
<a href=https://en.wikipedia.org/wiki/Man-in-the-middle_attack>man-in-the-middle-attack
</a>).</p><p>If you have verified the identity of the new server and choose to connect, the
server&rsquo;s IP and public key will be stored in the file <code>.ssh/known_hosts</code><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>
under your HOME directory. The next time you connect to the server, the
server&rsquo;s public key will be compared with the public key stored in
<code>known_hosts</code> to make sure that your connection to the server is secure.</p><p>Usually you will encounter the unauthorized warning the first time you log in a
server. If you encounter the warning the second time, it may be that the server
has changed its public key or you are under attack.</p><h2 id=set-up-public-key-login>Set up public key login</h2><p>As stated earlier, we can also set up public key login. First, we need to
generate a private and public key pair using <code>ssh-keygen</code>. We can use <code>-t</code> to
specify the type of key to create, e.g., <code>dsa</code>, <code>ecdsa</code>, <code>rsa</code>. We can use the
following command to generate a ecdsa key pair:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssh-keygen -t ecdsa
</span></span></code></pre></div><p>It will prompt you to enter a key file name and the passphrase for the private
key. You can press Enter to use the default values. The key pair will be
created under <code>$HOME/.ssh</code>. The private key file is <code>id_ecdsa</code> and the public
key file is <code>id_ecdsa.pub</code>. You must keep your private key safe. The public key
can be safely shown to others.</p><h3 id=transfer-your-public-key-to-server>Transfer your public key to server</h3><p>To enable host public key login, you must put your public key under the
<code>$HOME/.ssh</code> directory in the remote server. There are two ways.</p><ul><li><p>Copy public key manually: Copy the content of the public key. Log in to your
server and paste the public key to the file <code>$HOME/.ssh/authorized_keys</code> (if
this file does not exist, create the file first.).</p></li><li><p>Use ssh-copy-id: In some systems, there is tool called <code>ssh-copy-id</code> which
an copy the content of the public key to <code>$HOME/.ssh/authorized_keys</code> in the
host server. You can use the following command to copy the public key to the
server:</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-copy-id user@host_ip
</span></span></code></pre></div><h3 id=login-to-the-server>login to the server</h3><p>After setting up public key login, you can log in to the server without using
password:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssh -p xxx user@host_ip
</span></span></code></pre></div><p>The server will verify if the public key under user&rsquo;s directory corresponds
your private key. If they match, you will log in to the server automatically.</p><h1 id=references>References</h1><ul><li><a href=https://stackoverflow.com/questions/9607295/calculate-rsa-key-fingerprint>Generate key fingerprint in different format.</a></li><li><a href=https://superuser.com/questions/421997/what-is-a-ssh-key-fingerprint-and-how-is-it-generated>What is ssh key fingerprint?</a></li><li><a href=https://security.stackexchange.com/a/20710/174338>Difference between authorized_keys and known_hosts.</a>.</li><li><a href=https://superuser.com/a/421084/736190>What does it mean that a host&rsquo;s authenticity can not be established?</a>?</li><li><a href=https://www.linode.com/docs/security/authentication/use-public-key-authentication-with-ssh/>How to use public key authentification for ssh.</a>.</li><li><a href=https://unix.stackexchange.com/a/88872/221410>What is known_hosts file?</a>.</li><li><a href=https://askubuntu.com/questions/363207/what-is-the-difference-between-the-rsa-dsa-and-ecdsa-keys-that-ssh-uses>Difference between DSA, ECDSA, RSA?</a>.</li></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><code>SHA</code> has three algorithms in series, <code>SHA-1</code>, <code>SHA-2</code> and <code>SHA-3</code>. <code>SHA-1</code> is old, and the other two are newer.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>The public keys of the host server are stored in <code>/etc/ssh</code> directory, for example: <code>ssh_host_dsa_key.pub</code>, <code>ssh_host_rsa_key.pub</code>, <code>ssh_host_ecdsa_key.pub</code>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>To check the format of <code>known_hosts</code> file, see <code>man 7 sshd</code>.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>jdhao</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2019-10-27</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/ssh/>ssh</a></div><nav class=post-nav><a class=prev href=/2019/10/29/expect_script_learning/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">Learning Expect Programming</span>
<span class="prev-text nav-mobile">Prev</span>
</a><a class=next href=/2019/10/22/latex_techniques_s1/><span class="next-text nav-default">Nifty LaTeX Techniques -- Series 1</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=jdhao/jdhao.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:jdhao@hotmail.com class="iconfont icon-email" title=email></a><a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://github.com/jdhao class="iconfont icon-github" title=github></a><a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span><span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2017 -
2024<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script><script>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-113395108-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><script id=baidu_push>(function(){if(window.location.hostname==="localhost")return;var t,n,e=document.createElement("script");e.async=!0,n=window.location.protocol.split(":")[0],n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>