<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Bracketed Paste Mode in Terminal - Blowfish</title>
<meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="jdhao"><meta name=description content="A note on bracketed paste mode in terminal and Neovim.
"><meta name=generator content="Hugo 0.123.8 with theme even"><link rel=canonical href=https://jdhao.github.io/2021/02/01/bracketed_paste_mode/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:!0})</script><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><meta property="og:title" content="Bracketed Paste Mode in Terminal"><meta property="og:description" content="A note on bracketed paste mode in terminal and Neovim."><meta property="og:type" content="article"><meta property="og:url" content="https://jdhao.github.io/2021/02/01/bracketed_paste_mode/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-01T23:34:02+08:00"><meta property="article:modified_time" content="2021-10-16T15:44:55+02:00"><meta itemprop=name content="Bracketed Paste Mode in Terminal"><meta itemprop=description content="A note on bracketed paste mode in terminal and Neovim."><meta itemprop=datePublished content="2021-02-01T23:34:02+08:00"><meta itemprop=dateModified content="2021-10-16T15:44:55+02:00"><meta itemprop=wordCount content="492"><meta itemprop=keywords content="terminal,Nvim,Vim,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Bracketed Paste Mode in Terminal"><meta name=twitter:description content="A note on bracketed paste mode in terminal and Neovim."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>Blowfish</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/posts/><li class=mobile-menu-item>Archives</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>Blowfish</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/posts/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><div class=post-content><p>A note on bracketed paste mode in terminal and Neovim.</p><h1 id=annoying-character-inserted-when-pasting-text>Annoying character inserted when pasting text</h1><p>I use <a href=https://www.emtec.com/zoc/>ZOC terminal</a> to connect to my remote
server. Today, I noticed a strange issue when I copied text from elsewhere to
the terminal shell command line. When I copied some text and pasted it in the
terminal, I found that <code>0~</code> was added in the beginning of text, and <code>1~</code> was
added in the end of text.</p><p>I found <a href=https://unix.stackexchange.com/q/196098/221410>a similar issue</a> on
stackexchange. It turns out that this has something to do with <a href=https://cirw.in/blog/bracketed-paste>bracketed paste
mode</a> in terminal emulators.</p><h1 id=what-is-bracketed-paste-mode>What is bracketed paste mode</h1><p>Typically, when we paste code snippet into a terminal application, it can not
tell whether we are typing the text or we are pasting it. This may have
unintended side affects for some application. For example, Vim will auto-indent
the code pasted into it when it sees a newline, breaking the code structure.</p><p>Here comes the bracketed paste mode. When this feature is enabled, if we paste
text into terminal, the terminal will add some special sequence in the
beginning and end of the text (<code>\e[200~</code> in the beginning and <code>\e[201~</code> in the
end).</p><h2 id=how-enable-and-disale-it-in-terminal>How enable and disale it in terminal</h2><p>To check if bracketed paste mode is on and supported, first use <code>printf "\e[?2004h"</code>
to turn on it. Then copy some text, run <code>xxd</code>, and paste some text into
terminal. If you terminal supports bracketed paste mode, then you will see
output like the following:</p><pre tabindex=0><code>^[[200~some test^[[201~
</code></pre><p>To disable this mode, use <code>printf '\e[?2004l'</code>.</p><h2 id=why-is-it-important>Why is it important?</h2><p>But how is this even important? If a terminal program also supports bracketed
paste mode, it can interpret the special terminal sequence and know that the
user is pasting text instead of typing it.</p><p>A noticeable example is when we paste multi-line code into Vim. Since the code
have already been properly indented, we do not want Vim to alter it. Without
this terminal ability, Vim does not know whether you are typing the text or
paste it from the terminal. So when it meets a newline character, it will try
to re-indent the following line, causing a complete mess. If Vim supports
bracketed paste mode, when it see the special terminal sequence, it knows that
the user is trying to paste text into it. It will not auto-indent your pasted
text any more, thus you do not need to use <code>set paste</code> in order to paste
something.</p><h1 id=enable-bracketed-paste-mode-in-vimneovim>Enable bracketed paste mode in Vim/Neovim</h1><p>For plain Vim, see <a href=https://vi.stackexchange.com/q/25311/15292>this post</a> on
how to enable bracketed paste mode. If you are using Neovim, bracketed paste
mode in built-in, if your terminal supports it, you do not need to do any setup.
Neovim will just work, see also <code>:h bracketed-paste-mode</code> inside Neovim.</p><h1 id=ref>Ref</h1><ul><li><a href=https://github.com/ChrisJohnsen/tmux-MacOSX-pasteboard/issues/31>https://github.com/ChrisJohnsen/tmux-MacOSX-pasteboard/issues/31</a></li><li><a href=https://stackoverflow.com/q/44848979/6064933>Getting strange characters when pasting into my iterm2 terminal</a></li><li><a href=https://stackoverflow.com/a/50654284/6064933>How do I disable the weird characters from “bracketed paste mode” on the Mac OS X default terminal?</a></li><li><a href="https://news.ycombinator.com/item?id=18329305">https://news.ycombinator.com/item?id=18329305</a></li></ul></div></article></div></div></main><footer id=footer class=footer><div class=social-links><a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a>
</span><span class=copyright-year>&copy;
-
2024<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script></body></html>