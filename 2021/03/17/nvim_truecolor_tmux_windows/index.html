<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>Set up true color for nvim and tmux in Zoc terminal and xshell - jdhao's digital space</title>
<meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="jdhao"><meta name=description content="In my daily work, I often ssh to a remote server using a terminal emulator. My local machine is a Windows 10 desktop. In this post, I want to share how to make true color work across terminal emulator, nvim and tmux.
"><meta name=keywords content="Hugo,theme,even"><meta name=google-site-verification content="HTz0VHxqny_b0FfS774dICLBzHGBZCb_S11j_akF1Tw"><meta name=generator content="Hugo 0.123.8 with theme even"><link rel=canonical href=https://jdhao.github.io/2021/03/17/nvim_truecolor_tmux_windows/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6058871559165202",enable_page_level_ads:!0})</script><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:title" content="Set up true color for nvim and tmux in Zoc terminal and xshell"><meta property="og:description" content="In my daily work, I often ssh to a remote server using a terminal emulator. My
local machine is a Windows 10 desktop. In this post, I want to share how to
make true color work across terminal emulator, nvim and tmux."><meta property="og:type" content="article"><meta property="og:url" content="https://jdhao.github.io/2021/03/17/nvim_truecolor_tmux_windows/"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-03-17T21:06:12+08:00"><meta property="article:modified_time" content="2021-03-17T16:15:28+01:00"><meta itemprop=name content="Set up true color for nvim and tmux in Zoc terminal and xshell"><meta itemprop=description content="In my daily work, I often ssh to a remote server using a terminal emulator. My
local machine is a Windows 10 desktop. In this post, I want to share how to
make true color work across terminal emulator, nvim and tmux."><meta itemprop=datePublished content="2021-03-17T21:06:12+08:00"><meta itemprop=dateModified content="2021-03-17T16:15:28+01:00"><meta itemprop=wordCount content="463"><meta itemprop=keywords content="Nvim,terminal,Tmux,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Set up true color for nvim and tmux in Zoc terminal and xshell"><meta name=twitter:description content="In my daily work, I often ssh to a remote server using a terminal emulator. My
local machine is a Windows 10 desktop. In this post, I want to share how to
make true color work across terminal emulator, nvim and tmux."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>jdhao's digital space</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>Home</li></a><a href=/post/><li class=mobile-menu-item>Archives</li></a><a href=/categories/><li class=mobile-menu-item>Categories</li></a><a href=/tags/><li class=mobile-menu-item>Tags</li></a><a href=/about/><li class=mobile-menu-item>About</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>jdhao's digital space</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>Home</a></li><li class=menu-item><a class=menu-item-link href=/post/>Archives</a></li><li class=menu-item><a class=menu-item-link href=/categories/>Categories</a></li><li class=menu-item><a class=menu-item-link href=/tags/>Tags</a></li><li class=menu-item><a class=menu-item-link href=/about/>About</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Set up true color for nvim and tmux in Zoc terminal and xshell</h1><div class=post-meta><span class=post-time>2021-03-17</span><div class=post-category><a href=/categories/tools/>tools</a></div><span class=more-meta>463 words </span><span class=more-meta>3 mins read </span><span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#pick-a-suitable-terminal-emulator>Pick a suitable terminal emulator</a></li><li><a href=#enable-true-color-in-terminal-emulator>Enable true color in terminal emulator</a></li><li><a href=#make-true-color-work-with-tmux-and-nvim>Make true color work with tmux and nvim</a><ul><li><a href=#set-term-environment-variable>Set TERM environment variable</a></li><li><a href=#configure-tmux>Configure tmux</a></li></ul></li></ul></nav></div></div><div class=post-content><p>In my daily work, I often ssh to a remote server using a terminal emulator. My
local machine is a Windows 10 desktop. In this post, I want to share how to
make <a href=https://gist.github.com/XVilka/8346728>true color</a> work across terminal emulator, nvim and tmux.</p><h1 id=pick-a-suitable-terminal-emulator>Pick a suitable terminal emulator</h1><p>Not all terminal emulators support true colors. First, we need to use a
terminal emulator that supports true colors. Both <a href=https://www.emtec.com/zoc/>zoc terminal</a> and <a href=https://www.netsarang.com/en/xshell/>xshell</a> can
support this.</p><p>To test whether true color works or not, run the following script on the command line:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>awk <span class=s1>&#39;BEGIN{
</span></span></span><span class=line><span class=cl><span class=s1>    s=&#34;/\\/\\/\\/\\/\\&#34;; s=s s s s s s s s;
</span></span></span><span class=line><span class=cl><span class=s1>    for (colnum = 0; colnum&lt;77; colnum++) {
</span></span></span><span class=line><span class=cl><span class=s1>        r = 255-(colnum*255/76);
</span></span></span><span class=line><span class=cl><span class=s1>        g = (colnum*510/76);
</span></span></span><span class=line><span class=cl><span class=s1>        b = (colnum*255/76);
</span></span></span><span class=line><span class=cl><span class=s1>        if (g&gt;255) g = 510-g;
</span></span></span><span class=line><span class=cl><span class=s1>        printf &#34;\033[48;2;%d;%d;%dm&#34;, r,g,b;
</span></span></span><span class=line><span class=cl><span class=s1>        printf &#34;\033[38;2;%d;%d;%dm&#34;, 255-r,255-g,255-b;
</span></span></span><span class=line><span class=cl><span class=s1>        printf &#34;%s\033[0m&#34;, substr(s,colnum+1,1);
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>    printf &#34;\n&#34;;
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span>
</span></span></code></pre></div><p>If you can see a smooth color band, then true color has been activated
successfully.</p><h1 id=enable-true-color-in-terminal-emulator>Enable true color in terminal emulator</h1><p>In zoc terminal, true color support is enabled by default. Previously, true
color support is missing in xshell. The latest version of xshell (xshell 7) has
added support for true color, but this feature is disabled by default.</p><p>To enable true color support in xshell, go to <code>Tools --> Options</code>, click the
<code>Advanced</code> Tab page, under <code>Terminal</code> section, check the box <code>Use true color</code>.
We need to restart xshell to activate this feature. Open a source code file
using nvim, you should see that true color is working properly.</p><h1 id=make-true-color-work-with-tmux-and-nvim>Make true color work with tmux and nvim</h1><p>However, if we use nvim inside tmux, the colorscheme is still not right. In
order to make true color work inside tmux, we need a few more configuration.</p><h2 id=set-term-environment-variable>Set TERM environment variable</h2><p>The correct way to set the <code>TERM</code> variable is via the terminal emulators.</p><p>For zoc terminal, go to <code>Options --> Edit Session Profile</code>. Click <code>Emulations</code>,
in the left, choose <code>Xterm</code> from the list of emulations. Check <code>TERM</code> box below,
and set it to <code>xterm-256color</code>. On the right, also check the box <code>256 color support (TERM=xterm-256color)</code>.</p><p>For xshell, edit the properties of current session (<code>File --> Current Session Properties</code>). Click the <code>Terminal</code> category, and change <code>Terminal Type</code> to
<code>xterm-256color</code>.</p><p>Restart the current connection. Run command <code>echo $TERM</code> to verify that <code>TERM</code>
varialbe has been correctly set to <code>xterm-256color</code>.</p><h2 id=configure-tmux>Configure tmux</h2><p>Open tmux config (in <code>$HOME/.tmux.conf</code>) and add the following settings:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># True color settings, see https://jdhao.github.io/2018/10/19/tmux_nvim_true_color/ for the details.
</span></span><span class=line><span class=cl>set -g default-terminal &#34;screen-256color&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># If terminal supports true color, use the following options.
</span></span><span class=line><span class=cl>set -ga terminal-overrides &#34;,xterm-256color*:Tc&#34;
</span></span></code></pre></div><p>After these two steps, kill tmux server and start a new tmux session:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tmux kill-server
</span></span><span class=line><span class=cl>tmux new -s <span class=s2>&#34;test&#34;</span>
</span></span></code></pre></div><p>Then start nvim, your colorscheme<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> should work properly now.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A good colorscheme to check is <a href=https://github.com/morhetz/gruvbox>gruvbox</a>, which has great support for true color.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>jdhao</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2021-03-17</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/Nvim/>Nvim</a>
<a href=/tags/terminal/>terminal</a>
<a href=/tags/Tmux/>Tmux</a></div><nav class=post-nav><a class=prev href=/2021/03/22/my_recipe_20210321/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">菜谱；芹菜牛肉，清炒生菜</span>
<span class="prev-text nav-mobile">Prev</span>
</a><a class=next href=/2021/03/16/std_stream_buffering_in_python/><span class="next-text nav-default">print message not shown in nohup.out?</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=jdhao/jdhao.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:jdhao@hotmail.com class="iconfont icon-email" title=email></a><a href="https://stackoverflow.com/users/6064933/jdhao?tab=profile" class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://github.com/jdhao class="iconfont icon-github" title=github></a><a href=https://jdhao.github.io/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span><span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span><span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
2017 -
2024<span class=heart><i class="iconfont icon-heart"></i></span><span>jdhao</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script><script type=text/javascript>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],tags:"ams"}}</script><script async src=https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin=anonymous></script><script>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-113395108-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><script id=baidu_push>(function(){if(window.location.hostname==="localhost")return;var t,n,e=document.createElement("script");e.async=!0,n=window.location.protocol.split(":")[0],n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>